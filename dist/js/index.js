var dataList,len,control,timer,timeAll,root=window.player,audio=root.audioManager,deg=0,renderAlltime=root.pro.renderAlltime,timePlay=root.pro.timePlay,timePause=root.pro.timePause,start=root.pro.start;function getData(t){$.ajax({type:"GET",url:t,success:function(t){len=(dataList=t).length,control=new root.indexControl(len),root.render(t[0]),audio.getAudio(t[0].audio),root.playList.renderDom(t),timeAll=t[0].duration,renderAlltime(timeAll),bindEvent(),bindTouch()},error:function(){}})}function bindEvent(){$("body").on("play:change",function(t,o){timeAll=dataList[o].duration,root.render(dataList[o]),audio.getAudio(dataList[o].audio),renderAlltime(dataList[o].duration),$(".img-box").css({transform:"rotatez(0deg)",transition:"none"}),deg=0,"play"==audio.status&&(audio.play(),timePlay(),rotated(0))}),$(".prev").on("click",function(){var t=control.prev();$("body").trigger("play:change",t)}),$(".next").on("click",function(){var t=control.next();$("body").trigger("play:change",t)}),$(".play").on("click",function(){$(".play").toggleClass("playing"),"play"==audio.status?(audio.pause(),timePause(),clearInterval(timer),timer=null):(audio.play(),timePlay(),rotated())}),$(".list").on("click",function(){root.playList.show()})}function bindTouch(){var t=$(".pro-bottom").offset(),a=t.left,e=t.width;$(".slider").on("touchstart",function(t){timePause()}).on("touchmove",function(t){var o=t.changedTouches[0].clientX;start((o-a)/e*timeAll)}).on("touchend",function(t){var o=(t.changedTouches[0].clientX-a)/e*timeAll;$(".play").addClass("playing"),audio.play(),timePlay(),rotated(),audio.playTo(o)})}function rotated(){clearInterval(timer),timer=setInterval(function(){deg+=2,$(".img-box").css({transform:"rotatez("+deg+"deg)",transition:"transform 0.2s"})},200)}getData("../mock/data.json");